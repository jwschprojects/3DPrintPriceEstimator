<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Print Price Estimator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
            text-align: center;
        }
        h2 {
            color: #333;
        }
        table {
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
            border-collapse: collapse;
            background: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        th, td {
            padding: 12px;
            text-align: center;
        }
        th {
            background-color: #007BFF;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        input[type="number"] {
            width: 60px;
            padding: 5px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        input[type="checkbox"] {
            transform: scale(1.3);
        }
    </style>
</head>
<body>
    <h2>3D Print Price Estimator</h2>
    <table>
        <thead>
            <tr>
                <th>GUIDE</th>
                <th>FILAMENT COST (grams)</th>
                <th>PRINT TIME (hours)</th>
                <th>Keychain</th>
                <th>Switch</th>
                <th>Magnet</th>
                <th>PRICE (Rp)</th>
            </tr>
        </thead>
        <tbody id="table-body"></tbody>
    </table>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const data = [
                { guide: "0-50g" },
                { guide: "51-100g" },
                { guide: "101-300g" },
                { guide: "301-500g" },
                { guide: "> 500g" }
            ];

            function createTableRows(tableBodyId) {
                const tableBody = document.getElementById(tableBodyId);
                data.forEach((row, index) => {
                    const tr = document.createElement("tr");
                    tr.innerHTML = `
                        <td>${row.guide}</td>
                        <td><input type="number" class="filament" data-table="${tableBodyId}" data-index="${index}" value="0"></td>
                        <td><input type="number" class="print-time" data-table="${tableBodyId}" data-index="${index}" value="0"></td>
                        <td><input type="checkbox" class="addon" data-table="${tableBodyId}" data-index="${index}" data-addon="keychain"></td>
                        <td><input type="checkbox" class="addon" data-table="${tableBodyId}" data-index="${index}" data-addon="switch"></td>
                        <td><input type="checkbox" class="addon" data-table="${tableBodyId}" data-index="${index}" data-addon="magnet"></td>
                        <td id="price-${tableBodyId}-${index}">0</td>
                    `;
                    tableBody.appendChild(tr);
                });
            }

            createTableRows("table-body");

            function formatCurrency(value) {
                return value.toLocaleString("id-ID").replace(/\./g, ",");
            }

            function calculatePrice(tableBodyId) {
                const addonCosts = { keychain: 2000, switch: 3000, magnet: 2500 };
                const hourlyCosts = { "0-50g": 3000, "51-100g": 2800, "101-300g": 2700, "301-500g": 2500, "> 500g": 2500 };
                const margins = { "0-50g": 3, "51-100g": 2.8, "101-300g": 2.5, "301-500g": 2.5, "> 500g": 2.4 };

                document.querySelectorAll(`#${tableBodyId} tr`).forEach((row, index) => {
                    const guide = row.cells[0].textContent;
                    const filament = Number(row.querySelector(".filament").value);
                    const printTime = Number(row.querySelector(".print-time").value);
                    const hourlyCost = hourlyCosts[guide] || 3000;
                    const marginMultiplier = margins[guide] || 3;
                    
                    let baseCost = (((filament * 1.1) / 1000) * 160000) + (printTime * hourlyCost);
                    let totalCost = baseCost * marginMultiplier;
                    let totalPrice = Math.round(totalCost);
                    
                    row.querySelectorAll(".addon").forEach(checkbox => {
                        if (checkbox.checked) {
                            totalPrice += addonCosts[checkbox.dataset.addon];
                        }
                    });
                    
                    const priceCell = document.getElementById(`price-${tableBodyId}-${index}`);
                    
                    if (priceCell) {
                        priceCell.textContent = formatCurrency(totalPrice);
                    }
                });
            }

            document.addEventListener("input", (event) => {
                const tableBodyId = event.target.dataset.table;
                if (tableBodyId) {
                    calculatePrice(tableBodyId);
                }
            });
        });
    </script>
</body>
</html>
